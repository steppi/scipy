

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>scipy.spatial.transform.Rotation.align_vectors &#8212; SciPy vinteractive-docs-deploy Manual</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Vibur" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyterlite_sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/scipy.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/try_examples.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/jupyterlite_sphinx.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script data-domain="docs.scipy.org" defer="defer" src="https://views.scientific-python.org/js/script.js"></script>
    <script async="async" src="../../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/generated/scipy.spatial.transform.Rotation.align_vectors';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.2';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://scipy.github.io/devdocs/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'interactive-docs-deploy';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Mar 08, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.svg" class="logo__image only-light" alt="SciPy vinteractive-docs-deploy Manual - Home"/>
    <script>document.write(`<img src="../../_static/logo.svg" class="logo__image only-dark" alt="SciPy vinteractive-docs-deploy Manual - Home"/>`);</script>
  
  
</a></div>
    
      <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-external" href="https://scipy.org/install/">
                        Installing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../tutorial/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../index.html">
                        API reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../building/index.html">
                        Building from source
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../dev/index.html">
                        Development
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../release.html">
                        Release notes
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scipy/scipy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/SciPy_team" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-external" href="https://scipy.org/install/">
                        Installing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../tutorial/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../index.html">
                        API reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../building/index.html">
                        Building from source
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../dev/index.html">
                        Development
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../release.html">
                        Release notes
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scipy/scipy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/SciPy_team" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links" aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.__len__.html">scipy.spatial.transform.Rotation.__len__</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.from_quat.html">scipy.spatial.transform.Rotation.from_quat</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.from_matrix.html">scipy.spatial.transform.Rotation.from_matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.from_rotvec.html">scipy.spatial.transform.Rotation.from_rotvec</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.from_mrp.html">scipy.spatial.transform.Rotation.from_mrp</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.from_euler.html">scipy.spatial.transform.Rotation.from_euler</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.from_davenport.html">scipy.spatial.transform.Rotation.from_davenport</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.as_quat.html">scipy.spatial.transform.Rotation.as_quat</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.as_matrix.html">scipy.spatial.transform.Rotation.as_matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.as_rotvec.html">scipy.spatial.transform.Rotation.as_rotvec</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.as_mrp.html">scipy.spatial.transform.Rotation.as_mrp</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.as_euler.html">scipy.spatial.transform.Rotation.as_euler</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.as_davenport.html">scipy.spatial.transform.Rotation.as_davenport</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.concatenate.html">scipy.spatial.transform.Rotation.concatenate</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.apply.html">scipy.spatial.transform.Rotation.apply</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.__mul__.html">scipy.spatial.transform.Rotation.__mul__</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.__pow__.html">scipy.spatial.transform.Rotation.__pow__</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.inv.html">scipy.spatial.transform.Rotation.inv</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.magnitude.html">scipy.spatial.transform.Rotation.magnitude</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.approx_equal.html">scipy.spatial.transform.Rotation.approx_equal</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.mean.html">scipy.spatial.transform.Rotation.mean</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.reduce.html">scipy.spatial.transform.Rotation.reduce</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.create_group.html">scipy.spatial.transform.Rotation.create_group</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.__getitem__.html">scipy.spatial.transform.Rotation.__getitem__</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.identity.html">scipy.spatial.transform.Rotation.identity</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.spatial.transform.Rotation.random.html">scipy.spatial.transform.Rotation.random</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">scipy.spatial.transform.Rotation.align_vectors</a></li>
</ul>

  </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">scipy.spatia...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="scipy-spatial-transform-rotation-align-vectors">
<h1>scipy.spatial.transform.Rotation.align_vectors<a class="headerlink" href="#scipy-spatial-transform-rotation-align-vectors" title="Permalink to this heading">#</a></h1>
<dl class="py method">
<dt class="sig sig-object py" id="scipy.spatial.transform.Rotation.align_vectors">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Rotation.</span></span><span class="sig-name descname"><span class="pre">align_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sensitivity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scipy.spatial.transform.Rotation.align_vectors" title="Permalink to this definition">#</a></dt>
<dd><p>Estimate a rotation to optimally align two sets of vectors.</p>
<p>Find a rotation between frames A and B which best aligns a set of
vectors <em class="xref py py-obj">a</em> and <em class="xref py py-obj">b</em> observed in these frames. The following loss
function is minimized to solve for the rotation matrix
<span class="math notranslate nohighlight">\(C\)</span>:</p>
<div class="math notranslate nohighlight">
\[L(C) = \frac{1}{2} \sum_{i = 1}^{n} w_i \lVert \mathbf{a}_i -
C \mathbf{b}_i \rVert^2 ,\]</div>
<p>where <span class="math notranslate nohighlight">\(w_i\)</span>’s are the <em class="xref py py-obj">weights</em> corresponding to each vector.</p>
<p>The rotation is estimated with Kabsch algorithm <a class="reference internal" href="#r20eec99246c5-1" id="id1">[1]</a>, and solves what
is known as the “pointing problem”, or “Wahba’s problem” <a class="reference internal" href="#r20eec99246c5-2" id="id2">[2]</a>.</p>
<p>There are two special cases. The first is if a single vector is given
for <em class="xref py py-obj">a</em> and <em class="xref py py-obj">b</em>, in which the shortest distance rotation that aligns
<em class="xref py py-obj">b</em> to <em class="xref py py-obj">a</em> is returned.</p>
<p>The second is when one of the weights is infinity. In this case, the
shortest distance rotation between the primary infinite weight vectors
is calculated as above. Then, the rotation about the aligned primary
vectors is calculated such that the secondary vectors are optimally
aligned per the above loss function. The result is the composition
of these two rotations. The result via this process is the same as the
Kabsch algorithm as the corresponding weight approaches infinity in
the limit. For a single secondary vector this is known as the
“align-constrain” algorithm <a class="reference internal" href="#r20eec99246c5-3" id="id3">[3]</a>.</p>
<p>For both special cases (single vectors or an infinite weight), the
sensitivity matrix does not have physical meaning and an error will be
raised if it is requested. For an infinite weight, the primary vectors
act as a constraint with perfect alignment, so their contribution to
<em class="xref py py-obj">rssd</em> will be forced to 0 even if they are of different lengths.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>a</strong><span class="classifier">array_like, shape (3,) or (N, 3)</span></dt><dd><p>Vector components observed in initial frame A. Each row of <em class="xref py py-obj">a</em>
denotes a vector.</p>
</dd>
<dt><strong>b</strong><span class="classifier">array_like, shape (3,) or (N, 3)</span></dt><dd><p>Vector components observed in another frame B. Each row of <em class="xref py py-obj">b</em>
denotes a vector.</p>
</dd>
<dt><strong>weights</strong><span class="classifier">array_like shape (N,), optional</span></dt><dd><p>Weights describing the relative importance of the vector
observations. If None (default), then all values in <em class="xref py py-obj">weights</em> are
assumed to be 1. One and only one weight may be infinity, and
weights must be positive.</p>
</dd>
<dt><strong>return_sensitivity</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to return the sensitivity matrix. See Notes for details.
Default is False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>rotation</strong><span class="classifier"><a class="reference internal" href="scipy.spatial.transform.Rotation.html#scipy.spatial.transform.Rotation" title="scipy.spatial.transform.Rotation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Rotation</span></code></a> instance</span></dt><dd><p>Best estimate of the rotation that transforms <em class="xref py py-obj">b</em> to <em class="xref py py-obj">a</em>.</p>
</dd>
<dt><strong>rssd</strong><span class="classifier">float</span></dt><dd><p>Stands for “root sum squared distance”. Square root of the weighted
sum of the squared distances between the given sets of vectors
after alignment. It is equal to <code class="docutils literal notranslate"><span class="pre">sqrt(2</span> <span class="pre">*</span> <span class="pre">minimum_loss)</span></code>, where
<code class="docutils literal notranslate"><span class="pre">minimum_loss</span></code> is the loss function evaluated for the found
optimal rotation.
Note that the result will also be weighted by the vectors’
magnitudes, so perfectly aligned vector pairs will have nonzero
<em class="xref py py-obj">rssd</em> if they are not of the same length. So, depending on the
use case it may be desirable to normalize the input vectors to unit
length before calling this method.</p>
</dd>
<dt><strong>sensitivity_matrix</strong><span class="classifier">ndarray, shape (3, 3)</span></dt><dd><p>Sensitivity matrix of the estimated rotation estimate as explained
in Notes. Returned only when <em class="xref py py-obj">return_sensitivity</em> is True. Not
valid if aligning a single pair of vectors or if there is an
infinite weight, in which cases an error will be raised.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The sensitivity matrix gives the sensitivity of the estimated rotation
to small perturbations of the vector measurements. Specifically we
consider the rotation estimate error as a small rotation vector of
frame A. The sensitivity matrix is proportional to the covariance of
this rotation vector assuming that the vectors in <em class="xref py py-obj">a</em> was measured with
errors significantly less than their lengths. To get the true
covariance matrix, the returned sensitivity matrix must be multiplied
by harmonic mean <a class="reference internal" href="#r20eec99246c5-4" id="id4">[4]</a> of variance in each observation. Note that
<em class="xref py py-obj">weights</em> are supposed to be inversely proportional to the observation
variances to get consistent results. For example, if all vectors are
measured with the same accuracy of 0.01 (<em class="xref py py-obj">weights</em> must be all equal),
then you should multiple the sensitivity matrix by 0.01**2 to get the
covariance.</p>
<p>Refer to <a class="reference internal" href="#r20eec99246c5-5" id="id5">[5]</a> for more rigorous discussion of the covariance
estimation. See <a class="reference internal" href="#r20eec99246c5-6" id="id6">[6]</a> for more discussion of the pointing problem and
minimal proper pointing.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r20eec99246c5-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Kabsch_algorithm">https://en.wikipedia.org/wiki/Kabsch_algorithm</a></p>
</div>
<div class="citation" id="r20eec99246c5-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Wahba%27s_problem">https://en.wikipedia.org/wiki/Wahba%27s_problem</a></p>
</div>
<div class="citation" id="r20eec99246c5-3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>Magner, Robert,
“Extending target tracking capabilities through trajectory and
momentum setpoint optimization.” Small Satellite Conference,
2018.</p>
</div>
<div class="citation" id="r20eec99246c5-4" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Harmonic_mean">https://en.wikipedia.org/wiki/Harmonic_mean</a></p>
</div>
<div class="citation" id="r20eec99246c5-5" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">5</a><span class="fn-bracket">]</span></span>
<p>F. Landis Markley,
“Attitude determination using vector observations: a fast
optimal matrix algorithm”, Journal of Astronautical Sciences,
Vol. 41, No.2, 1993, pp. 261-280.</p>
</div>
<div class="citation" id="r20eec99246c5-6" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">6</a><span class="fn-bracket">]</span></span>
<p>Bar-Itzhack, Itzhack Y., Daniel Hershkowitz, and Leiba Rodman,
“Pointing in Real Euclidean Space”, Journal of Guidance,
Control, and Dynamics, Vol. 20, No. 5, 1997, pp. 916-922.</p>
</div>
</div>
<p class="rubric">Examples</p>
<div class="try_examples_outer_container docutils container" id="923813bd-2654-43a0-8e0b-aea8772dd906">
<div class="try_examples_button_container"><button class="try_examples_button" onclick="window.tryExamplesShowIframe('923813bd-2654-43a0-8e0b-aea8772dd906','a8a139a1-763a-4e3b-8383-e8c3ea3b1607','c2e0d385-cd5b-4c31-9365-67f1fed52b33','../../lite/tree/../notebooks/?path=c5269a0d_d2d0_4377_ba6e_5770b3853ef7.ipynb','None')">Try it in your browser!</button></div><div class="try_examples_content docutils container">
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.spatial.transform</span> <span class="kn">import</span> <span class="n">Rotation</span> <span class="k">as</span> <span class="n">R</span>
</pre></div>
</div>
<p>Here we run the baseline Kabsch algorithm to best align two sets of
vectors, where there is noise on the last two vector measurements of
the <code class="docutils literal notranslate"><span class="pre">b</span></code> set:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span><span class="p">,</span> <span class="n">rssd</span><span class="p">,</span> <span class="n">sens</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">align_vectors</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">return_sensitivity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="go">array([[0., 0., 1.],</span>
<span class="go">       [1., 0., 0.],</span>
<span class="go">       [0., 1., 0.]])</span>
</pre></div>
</div>
<p>When we apply the rotation to <code class="docutils literal notranslate"><span class="pre">b</span></code>, we get vectors close to <code class="docutils literal notranslate"><span class="pre">a</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">array([[0. , 1. , 0. ],</span>
<span class="go">       [0. , 1. , 1.1],</span>
<span class="go">       [0. , 1. , 0.9]])</span>
</pre></div>
</div>
<p>The error for the first vector is 0, and for the last two the error is
magnitude 0.1. The <em class="xref py py-obj">rssd</em> is the square root of the sum of the
weighted squared errors, and the default weights are all 1, so in this
case the <em class="xref py py-obj">rssd</em> is calculated as
<code class="docutils literal notranslate"><span class="pre">sqrt(1</span> <span class="pre">*</span> <span class="pre">0**2</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">*</span> <span class="pre">0.1**2</span> <span class="pre">+</span> <span class="pre">1</span> <span class="pre">*</span> <span class="pre">(-0.1)**2)</span> <span class="pre">=</span> <span class="pre">0.141421356237308</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">-</span> <span class="n">rot</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">array([[ 0., 0.,  0. ],</span>
<span class="go">       [ 0., 0., -0.1],</span>
<span class="go">       [ 0., 0.,  0.1]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">@</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">rot</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">b</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="go">0.141421356237308</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rssd</span>
<span class="go">0.141421356237308</span>
</pre></div>
</div>
<p>The sensitivity matrix for this example is as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sens</span>
<span class="go">array([[0.2, 0. , 0.],</span>
<span class="go">       [0. , 1.5, 1.],</span>
<span class="go">       [0. , 1. , 1.]])</span>
</pre></div>
</div>
<p>Special case 1: Find a minimum rotation between single vectors:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">align_vectors</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="go">array([[0., 1., 0.],</span>
<span class="go">       [-1., 0., 0.],</span>
<span class="go">       [0., 0., 1.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">array([1., 0., 0.])</span>
</pre></div>
</div>
<p>Special case 2: One infinite weight. Here we find a rotation between
primary and secondary vectors that can align exactly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">align_vectors</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="go">array([[0., 0., 1.],</span>
<span class="go">       [1., 0., 0.],</span>
<span class="go">       [0., 1., 0.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">array([[0., 1., 0.],</span>
<span class="go">       [0., 1., 1.]])</span>
</pre></div>
</div>
<p>Here the secondary vectors must be best-fit:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">align_vectors</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="go">array([[0., 0., 1.],</span>
<span class="go">       [1., 0., 0.],</span>
<span class="go">       [0., 1., 0.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">array([[0., 1., 0.],</span>
<span class="go">       [0., 1., 2.]])</span>
</pre></div>
</div>
</div>
</div>
<div id="c2e0d385-cd5b-4c31-9365-67f1fed52b33" class="try_examples_outer_iframe  hidden"><div class="try_examples_button_container"><button class="try_examples_button" onclick="window.tryExamplesHideIframe('923813bd-2654-43a0-8e0b-aea8772dd906','c2e0d385-cd5b-4c31-9365-67f1fed52b33')">Go Back</button><button class="try_examples_button" onclick="window.openInNewTab('923813bd-2654-43a0-8e0b-aea8772dd906','c2e0d385-cd5b-4c31-9365-67f1fed52b33')">Open In Tab</button></div><div id="a8a139a1-763a-4e3b-8383-e8c3ea3b1607" class="jupyterlite_sphinx_iframe_container"></div></div><script>document.addEventListener("DOMContentLoaded", function() {window.loadTryExamplesConfig("../../try_examples.json");});</script></dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scipy.spatial.transform.Rotation.align_vectors"><code class="docutils literal notranslate"><span class="pre">Rotation.align_vectors</span></code></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2008-2024, The SciPy community.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>